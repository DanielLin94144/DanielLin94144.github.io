---
layout: default
---

{% include base_path %}

<style>
    .bilingual-container {
        display: flex;
        flex-wrap: wrap;
        max-width: 1200px;
        margin: 0 auto;
        padding: 1rem;
    }

    .bilingual-sidebar {
        width: 250px;
        flex-shrink: 0;
        padding-right: 2rem;
    }

    .bilingual-content {
        flex: 1;
        min-width: 300px;
    }

    @media (max-width: 768px) {
        .bilingual-sidebar {
            width: 100%;
            padding-right: 0;
            margin-bottom: 2rem;
        }

        .bilingual-content {
            width: 100%;
        }
    }

    .lang-toggle {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #e1e4e8;
    }

    .lang-toggle button {
        padding: 0.5rem 1rem;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        font-size: 0.875rem;
        cursor: pointer;
    }

    .lang-active-zh {
        background: #28a745 !important;
        color: white !important;
        border-color: #28a745 !important;
    }

    .lang-active-en {
        background: #343a40 !important;
        color: white !important;
        border-color: #343a40 !important;
    }

    .lang-inactive {
        background: #f6f8fa;
        color: #24292e;
        border-color: #d1d5da;
    }
</style>

<div class="bilingual-container">
    <aside class="bilingual-sidebar">
        {% include author-profile.html %}
    </aside>

    <main class="bilingual-content">
        <article class="page">
            <header>
                {% if page.title %}<h1 class="page__title">{{ page.title | markdownify | remove: "<p>" | remove: "</p>"
                    }}</h1>{% endif %}
                {% if page.read_time %}<p class="page__meta"><i class="fa fa-clock-o"></i> {% include read-time.html %}
                </p>{% endif %}
                {% if page.date %}<p class="page__date"><strong><i class="fa fa-fw fa-calendar"></i> Published:</strong>
                    <time>{{ page.date | date: "%B %d, %Y" }}</time>
                </p>{% endif %}
            </header>

            <div class="lang-toggle">
                <button type="button" id="btnZh" class="lang-inactive" onclick="switchLang('zh')">繁體中文</button>
                <button type="button" id="btnEn" class="lang-active-en" onclick="switchLang('en')">English</button>
            </div>

            <section class="page__content">
                {{ content }}
            </section>

            <footer class="page__meta">
                {% include page__taxonomy.html %}
            </footer>
        </article>
    </main>
</div>

<script type="text/javascript">
    (function() {
        // Logging helper
        function log(msg) {
            console.log('[Bilingual]: ' + msg);
        }

        // Get URL parameter
        function getUrlParam(param) {
            try {
                var urlParams = new URLSearchParams(window.location.search);
                return urlParams.get(param);
            } catch (e) {
                log('Error getting URL param: ' + e);
                return null;
            }
        }

        // Update URL without reloading page
        function updateUrl(lang) {
            try {
                if (window.history && window.history.replaceState) {
                    var url = new URL(window.location.href);
                    url.searchParams.set('lang', lang);
                    window.history.replaceState({}, '', url);
                }
            } catch (e) {
                log('Error updating URL: ' + e);
            }
        }

        // Switch language function - Attached to window so onclick works
        window.switchLang = function(lang) {
            log('Switching to: ' + lang);

            var zh = document.getElementById('content-zh');
            var en = document.getElementById('content-en');
            var btnZh = document.getElementById('btnZh');
            var btnEn = document.getElementById('btnEn');

            if (!zh || !en) {
                log('Critical: Content elements not found!');
                // Try to find by class if ID fails (fallback)
                if (!zh) zh = document.querySelector('.content-zh');
                if (!en) en = document.querySelector('.content-en');
            }

            if (lang === 'en') {
                if (zh) zh.style.display = 'none';
                if (en) en.style.display = 'block';
                if (btnZh) {
                    btnZh.className = ''; 
                    btnZh.classList.add('lang-inactive');
                }
                if (btnEn) {
                    btnEn.className = '';
                    btnEn.classList.add('lang-active-en');
                }
            } else {
                if (zh) zh.style.display = 'block';
                if (en) en.style.display = 'none';
                if (btnZh) {
                    btnZh.className = '';
                    btnZh.classList.add('lang-active-zh');
                }
                if (btnEn) {
                    btnEn.className = '';
                    btnEn.classList.add('lang-inactive');
                }
            }

            // Update URL
            updateUrl(lang);
        };

        // Initialize on load
        function init() {
            log('Initializing...');
            var lang = getUrlParam('lang') || 'en'; // Default to English
            window.switchLang(lang);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    })();
</script>